<!DOCTYPE html>
<html lang="ja">
<head>
  <meta charset="UTF-8">
  <title>アラームアプリ</title>
</head>
<body>
  <h1>アラームをセットしよう</h1>

  <input type="time" id="alarmTime">
  <button onclick="setAlarm()">アラームセット</button>

  <h2 id="status"></h2>

  <script>
    let alarmTime = null;
    let alarmTimeout = null;

    function setAlarm() {
      const input = document.getElementById('alarmTime').value;
      if (!input) {
        alert('時間を設定してください！');
        return;
      }

      const now = new Date();
      const [hours, minutes] = input.split(':').map(Number);
      const alarm = new Date();

      alarm.setHours(hours);
      alarm.setMinutes(minutes);
      alarm.setSeconds(0);

      if (alarm <= now) {
        // 設定時間がすでに過ぎていたら、次の日にセット
        alarm.setDate(alarm.getDate() + 1);
      }

      const timeToAlarm = alarm - now;

      if (alarmTimeout) {
        clearTimeout(alarmTimeout);
      }

      alarmTimeout = setTimeout(() => {
        alert('アラームです！');
        document.getElementById('status').textContent = 'アラーム鳴った！';
      }, timeToAlarm);

      document.getElementById('status').textContent = `アラームを ${input} にセットしました！`;
    }
  </script>
</body>
</html>